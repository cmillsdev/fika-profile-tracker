{% extends "base.html" %}

{% block title %}Stats - {{ player_id }}{% endblock %}

{% block content %}
    <h1>Stats for Player {{ player_id }}</h1>

    <!-- Cheevos Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#cheevosSection" role="button">
            <h2>Achievements</h2>
        </div>
        <div class="collapse" id="cheevosSection">
            <div class="card-body">
                <ul>
                    {% for achievement, description in stats.cheevos.items() %}
                        <li><strong>{{ achievement }}:</strong> {{ description }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Misc Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#miscSection" role="button">
            <h2>Miscellaneous</h2>
        </div>
        <div class="collapse" id="miscSection">
            <div class="card-body">
                <ul>
                    {% for key, value in stats.misc.items() %}
                        <li><strong>{{ key }}:</strong> {{ value }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Overall Counters Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#overallCountersSection" role="button">
            <h2>Overall Counters</h2>
        </div>
        <div class="collapse" id="overallCountersSection">
            <div class="card-body">
                <ul>
                    {% for key, value in stats.overall_counters.items() %}
                        <li><strong>{{ key }}:</strong> {{ value }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Session Counters Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#sessionCountersSection" role="button">
            <h2>Session Counters</h2>
        </div>
        <div class="collapse" id="sessionCountersSection">
            <div class="card-body">
                <ul>
                    {% for key, value in stats.session_counters.items() %}
                        <li><strong>{{ key }}:</strong> {{ value }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Skills Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#skillsSection" role="button">
            <h2>Skills</h2>
        </div>
        <div class="collapse" id="skillsSection">
            <div class="card-body">
                <h3>Common Skills</h3>
                <ul>
                    {% for skill, level in stats.skills_common.items() %}
                        <li><strong>{{ skill }}:</strong> {{ level }}</li>
                    {% endfor %}
                </ul>
                <h3>Mastering Skills</h3>
                <ul>
                    {% for weapon, level in stats.skills_mastering.items() %}
                        <li><strong>{{ weapon }}:</strong> {{ level }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Traders Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#tradersSection" role="button">
            <h2>Traders</h2>
        </div>
        <div class="collapse" id="tradersSection">
            <div class="card-body">
                <ul>
                    {% for trader, details in stats.traders.items() %}
                        <li>
                            <strong>{{ trader }}:</strong>
                            <ul>
                                <li>Standing: {{ details.standing }}</li>
                                <li>Sales Sum: {{ details.sales_sum }}</li>
                            </ul>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Hideout Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#hideoutSection" role="button">
            <h2>Hideout</h2>
        </div>
        <div class="collapse" id="hideoutSection">
            <div class="card-body">
                <ul>
                    {% for area, details in stats.hideout.items() %}
                        <li>
                            <strong>{{ area }} (Level {{ details.current_level }}):</strong>
                            {% if details.required %}
                                <ul>
                                    {% for requirement in details.required %}
                                        <li>{{ requirement }}</li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                No requirements.
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Last Death Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#lastDeathSection" role="button">
            <h2>Last Death</h2>
        </div>
        <div class="collapse" id="lastDeathSection">
            <div class="card-body">
                <ul>
                    <li><strong>Killer:</strong> {{ stats.last_death.killer.name }} ({{ stats.last_death.killer.side }})</li>
                    <li><strong>Weapon:</strong> {{ stats.last_death.killer.weapon }}</li>
                    <li><strong>Cause:</strong> {{ stats.last_death.cause.damage_type }} ({{ stats.last_death.cause.weapon }})</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Victims Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#victimsSection" role="button">
            <h2>Victims</h2>
        </div>
        <div class="collapse" id="victimsSection">
            <div class="card-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Name</th>
                            <th>Side</th>
                            <th>Level</th>
                            <th>Body Part</th>
                            <th>Weapon</th>
                            <th>Distance</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for victim in stats.victims %}
                            <tr>
                                <td>{{ victim.time }}</td>
                                <td>{{ victim.name }}</td>
                                <td>{{ victim.side }}</td>
                                <td>{{ victim.level }}</td>
                                <td>{{ victim.body_part }}</td>
                                <td>{{ victim.weapon }}</td>
                                <td>{{ victim.distance }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Bonuses Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#bonusesSection" role="button">
            <h2>Bonuses</h2>
        </div>
        <div class="collapse" id="bonusesSection">
            <div class="card-body">
                <ul>
                    {% for bonus in stats.bonuses %}
                        <li><strong>{{ bonus.type }}:</strong> {{ bonus.value }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Mini Quest Info Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#miniQuestInfoSection" role="button">
            <h2>Mini Quest Info</h2>
        </div>
        <div class="collapse" id="miniQuestInfoSection">
            <div class="card-body">
                <ul>
                    <li><strong>Active Quests:</strong> {{ stats.mini_quest_info.active }}</li>
                    <li><strong>Finished Quests:</strong> {{ stats.mini_quest_info.finished }}</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Accuracy Section -->
    <div class="card mb-3">
        <div class="card-header" data-bs-toggle="collapse" href="#accuracySection" role="button">
            <h2>Accuracy</h2>
        </div>
        <div class="collapse" id="accuracySection">
            <div class="card-body">
                <ul>
                    <li><strong>Overall Accuracy:</strong> {{ stats.overall_accuracy }}</li>
                    <li><strong>Session Accuracy:</strong> {{ stats.session_accuracy }}</li>
                </ul>
            </div>
        </div>
    </div>
{% endblock %}